<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/gao/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/gao/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/gao/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/gao/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/gao/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/gao/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/gao/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="机器学习,编程,python," />










<meta name="description" content="准备工作  本文为参加唐宇迪博士的课程的学习记录,想要了解更多内容,请到网易云购买唐宇迪博士的python数据分析与机器学习课程. 本文内容是用jupyter notebook运行的,推荐大家使用. 本文的python安装包包为anaconda的python3发行版.    12345import pandas as pdimport matplotlib.pyplot as pltimport">
<meta name="keywords" content="机器学习,编程,python">
<meta property="og:type" content="article">
<meta property="og:title" content="逻辑回归学习-以信用卡欺诈检测为例">
<meta property="og:url" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/index.html">
<meta property="og:site_name" content="JIAWEI">
<meta property="og:description" content="准备工作  本文为参加唐宇迪博士的课程的学习记录,想要了解更多内容,请到网易云购买唐宇迪博士的python数据分析与机器学习课程. 本文内容是用jupyter notebook运行的,推荐大家使用. 本文的python安装包包为anaconda的python3发行版.    12345import pandas as pdimport matplotlib.pyplot as pltimport">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_7_1.png">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_22_1.png">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_24_1.png">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_26_1.png">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_28_1.png">
<meta property="og:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_36_1.png">
<meta property="og:updated_time" content="2018-01-01T08:35:05.353Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="逻辑回归学习-以信用卡欺诈检测为例">
<meta name="twitter:description" content="准备工作  本文为参加唐宇迪博士的课程的学习记录,想要了解更多内容,请到网易云购买唐宇迪博士的python数据分析与机器学习课程. 本文内容是用jupyter notebook运行的,推荐大家使用. 本文的python安装包包为anaconda的python3发行版.    12345import pandas as pdimport matplotlib.pyplot as pltimport">
<meta name="twitter:image" content="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/output_7_1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/gao/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://gaojiawei.gitee.io/gao/2018/01/01/LogisticRegression-CreditCard/"/>





  <title>逻辑回归学习-以信用卡欺诈检测为例 | JIAWEI</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/gao/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JIAWEI</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">整齐严肃,主一无适</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/gao/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/gao/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/gao/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/gao/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/gao/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaojiawei.gitee.io/gao/gao/2018/01/01/LogisticRegression-CreditCard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jiawei">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/gao/upload/image/me.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JIAWEI">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">逻辑回归学习-以信用卡欺诈检测为例</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-01T16:19:10+08:00">
                2018-01-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/gao/categories/编程/" itemprop="url" rel="index">
                    <span itemprop="name">编程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><blockquote>
<ul>
<li>本文为参加唐宇迪博士的课程的学习记录,想要了解更多内容,请到网易云购买唐宇迪博士的<a href="http://study.163.com/course/introduction/1003590004.htm" target="_blank" rel="noopener">python数据分析与机器学习</a>课程.</li>
<li>本文内容是用jupyter notebook运行的,推荐大家使用.</li>
<li>本文的python安装包包为<a href="https://www.anaconda.com/download/" target="_blank" rel="noopener">anaconda</a>的python3发行版. </li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">%matplotlib inline</span><br></pre></td></tr></table></figure>
<h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">data = pd.read_csv(<span class="string">"creditcard.csv"</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>Time</th><br>      <th>V1</th><br>      <th>V2</th><br>      <th>V3</th><br>      <th>V4</th><br>      <th>V5</th><br>      <th>V6</th><br>      <th>V7</th><br>      <th>V8</th><br>      <th>V9</th><br>      <th>…</th><br>      <th>V21</th><br>      <th>V22</th><br>      <th>V23</th><br>      <th>V24</th><br>      <th>V25</th><br>      <th>V26</th><br>      <th>V27</th><br>      <th>V28</th><br>      <th>Amount</th><br>      <th>Class</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>0.0</td><br>      <td>-1.359807</td><br>      <td>-0.072781</td><br>      <td>2.536347</td><br>      <td>1.378155</td><br>      <td>-0.338321</td><br>      <td>0.462388</td><br>      <td>0.239599</td><br>      <td>0.098698</td><br>      <td>0.363787</td><br>      <td>…</td><br>      <td>-0.018307</td><br>      <td>0.277838</td><br>      <td>-0.110474</td><br>      <td>0.066928</td><br>      <td>0.128539</td><br>      <td>-0.189115</td><br>      <td>0.133558</td><br>      <td>-0.021053</td><br>      <td>149.62</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>0.0</td><br>      <td>1.191857</td><br>      <td>0.266151</td><br>      <td>0.166480</td><br>      <td>0.448154</td><br>      <td>0.060018</td><br>      <td>-0.082361</td><br>      <td>-0.078803</td><br>      <td>0.085102</td><br>      <td>-0.255425</td><br>      <td>…</td><br>      <td>-0.225775</td><br>      <td>-0.638672</td><br>      <td>0.101288</td><br>      <td>-0.339846</td><br>      <td>0.167170</td><br>      <td>0.125895</td><br>      <td>-0.008983</td><br>      <td>0.014724</td><br>      <td>2.69</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>1.0</td><br>      <td>-1.358354</td><br>      <td>-1.340163</td><br>      <td>1.773209</td><br>      <td>0.379780</td><br>      <td>-0.503198</td><br>      <td>1.800499</td><br>      <td>0.791461</td><br>      <td>0.247676</td><br>      <td>-1.514654</td><br>      <td>…</td><br>      <td>0.247998</td><br>      <td>0.771679</td><br>      <td>0.909412</td><br>      <td>-0.689281</td><br>      <td>-0.327642</td><br>      <td>-0.139097</td><br>      <td>-0.055353</td><br>      <td>-0.059752</td><br>      <td>378.66</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>1.0</td><br>      <td>-0.966272</td><br>      <td>-0.185226</td><br>      <td>1.792993</td><br>      <td>-0.863291</td><br>      <td>-0.010309</td><br>      <td>1.247203</td><br>      <td>0.237609</td><br>      <td>0.377436</td><br>      <td>-1.387024</td><br>      <td>…</td><br>      <td>-0.108300</td><br>      <td>0.005274</td><br>      <td>-0.190321</td><br>      <td>-1.175575</td><br>      <td>0.647376</td><br>      <td>-0.221929</td><br>      <td>0.062723</td><br>      <td>0.061458</td><br>      <td>123.50</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>2.0</td><br>      <td>-1.158233</td><br>      <td>0.877737</td><br>      <td>1.548718</td><br>      <td>0.403034</td><br>      <td>-0.407193</td><br>      <td>0.095921</td><br>      <td>0.592941</td><br>      <td>-0.270533</td><br>      <td>0.817739</td><br>      <td>…</td><br>      <td>-0.009431</td><br>      <td>0.798278</td><br>      <td>-0.137458</td><br>      <td>0.141267</td><br>      <td>-0.206010</td><br>      <td>0.502292</td><br>      <td>0.219422</td><br>      <td>0.215153</td><br>      <td>69.99</td><br>      <td>0</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 31 columns</p><br></div>



<h3 id="统计数据样本分布是否均衡"><a href="#统计数据样本分布是否均衡" class="headerlink" title="统计数据样本分布是否均衡"></a>统计数据样本分布是否均衡</h3><h4 id="下采样"><a href="#下采样" class="headerlink" title="下采样"></a>下采样</h4><p>两个样本数据不匹配，所以我们要想办法使得两种样本数量一样，下采样是指让两种样本数量一样多。</p>
<h4 id="上采样"><a href="#上采样" class="headerlink" title="上采样"></a>上采样</h4><p>上采样是让两种样本数量一样多，向最多的看齐。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">count_classes = pd.value_counts(data[<span class="string">'Class'</span>], sort = <span class="keyword">True</span>).sort_index()</span><br><span class="line">count_classes.plot(kind = <span class="string">'bar'</span>)</span><br><span class="line">plt.title(<span class="string">"Fraud class histogram"</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Class"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Frequency"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Text(0,0.5,&apos;Frequency&apos;)
</code></pre><p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_7_1.png" alt="png"></p>
<h3 id="处理权重数据"><a href="#处理权重数据" class="headerlink" title="处理权重数据"></a>处理权重数据</h3><p>我们发现有一列数据异常的大，在机器学习的时候，它会容易认为大的数据的权重更大，所以我们要将其统一。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sklearn.preprocessing 是sklearn包中的一个用于数据预处理的模块，standardscaler是一个数据标准化的模块。</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="comment">#DataFrame.reshape将数据变为一个列向量，其中-1是自动，1是后面的一位==》变为n*1。</span></span><br><span class="line">data[<span class="string">'normAmount'</span>] = StandardScaler().fit_transform(data[<span class="string">'Amount'</span>].values.reshape(<span class="number">-1</span>, <span class="number">1</span>))</span><br><span class="line">data = data.drop([<span class="string">'Time'</span>,<span class="string">'Amount'</span>],axis=<span class="number">1</span>)</span><br><span class="line">data.head()</span><br></pre></td></tr></table></figure>
<div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>V1</th><br>      <th>V2</th><br>      <th>V3</th><br>      <th>V4</th><br>      <th>V5</th><br>      <th>V6</th><br>      <th>V7</th><br>      <th>V8</th><br>      <th>V9</th><br>      <th>V10</th><br>      <th>…</th><br>      <th>V21</th><br>      <th>V22</th><br>      <th>V23</th><br>      <th>V24</th><br>      <th>V25</th><br>      <th>V26</th><br>      <th>V27</th><br>      <th>V28</th><br>      <th>Class</th><br>      <th>normAmount</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>-1.359807</td><br>      <td>-0.072781</td><br>      <td>2.536347</td><br>      <td>1.378155</td><br>      <td>-0.338321</td><br>      <td>0.462388</td><br>      <td>0.239599</td><br>      <td>0.098698</td><br>      <td>0.363787</td><br>      <td>0.090794</td><br>      <td>…</td><br>      <td>-0.018307</td><br>      <td>0.277838</td><br>      <td>-0.110474</td><br>      <td>0.066928</td><br>      <td>0.128539</td><br>      <td>-0.189115</td><br>      <td>0.133558</td><br>      <td>-0.021053</td><br>      <td>0</td><br>      <td>0.244964</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>1.191857</td><br>      <td>0.266151</td><br>      <td>0.166480</td><br>      <td>0.448154</td><br>      <td>0.060018</td><br>      <td>-0.082361</td><br>      <td>-0.078803</td><br>      <td>0.085102</td><br>      <td>-0.255425</td><br>      <td>-0.166974</td><br>      <td>…</td><br>      <td>-0.225775</td><br>      <td>-0.638672</td><br>      <td>0.101288</td><br>      <td>-0.339846</td><br>      <td>0.167170</td><br>      <td>0.125895</td><br>      <td>-0.008983</td><br>      <td>0.014724</td><br>      <td>0</td><br>      <td>-0.342475</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>-1.358354</td><br>      <td>-1.340163</td><br>      <td>1.773209</td><br>      <td>0.379780</td><br>      <td>-0.503198</td><br>      <td>1.800499</td><br>      <td>0.791461</td><br>      <td>0.247676</td><br>      <td>-1.514654</td><br>      <td>0.207643</td><br>      <td>…</td><br>      <td>0.247998</td><br>      <td>0.771679</td><br>      <td>0.909412</td><br>      <td>-0.689281</td><br>      <td>-0.327642</td><br>      <td>-0.139097</td><br>      <td>-0.055353</td><br>      <td>-0.059752</td><br>      <td>0</td><br>      <td>1.160686</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>-0.966272</td><br>      <td>-0.185226</td><br>      <td>1.792993</td><br>      <td>-0.863291</td><br>      <td>-0.010309</td><br>      <td>1.247203</td><br>      <td>0.237609</td><br>      <td>0.377436</td><br>      <td>-1.387024</td><br>      <td>-0.054952</td><br>      <td>…</td><br>      <td>-0.108300</td><br>      <td>0.005274</td><br>      <td>-0.190321</td><br>      <td>-1.175575</td><br>      <td>0.647376</td><br>      <td>-0.221929</td><br>      <td>0.062723</td><br>      <td>0.061458</td><br>      <td>0</td><br>      <td>0.140534</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>-1.158233</td><br>      <td>0.877737</td><br>      <td>1.548718</td><br>      <td>0.403034</td><br>      <td>-0.407193</td><br>      <td>0.095921</td><br>      <td>0.592941</td><br>      <td>-0.270533</td><br>      <td>0.817739</td><br>      <td>0.753074</td><br>      <td>…</td><br>      <td>-0.009431</td><br>      <td>0.798278</td><br>      <td>-0.137458</td><br>      <td>0.141267</td><br>      <td>-0.206010</td><br>      <td>0.502292</td><br>      <td>0.219422</td><br>      <td>0.215153</td><br>      <td>0</td><br>      <td>-0.073403</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 30 columns</p><br></div>



<h4 id="下采样-1"><a href="#下采样-1" class="headerlink" title="下采样"></a>下采样</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># X取出所有的数据，取出结果，Y取出结果。</span></span><br><span class="line">X = data.iloc[:, data.columns != <span class="string">'Class'</span>]</span><br><span class="line">y = data.iloc[:, data.columns == <span class="string">'Class'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of data points in the minority class</span></span><br><span class="line"><span class="comment"># data.calss == 1是一个列表，它又可以作为一个索引，把结果为true的数据都取出来。</span></span><br><span class="line">number_records_fraud = len(data[data.Class == <span class="number">1</span>])</span><br><span class="line">fraud_indices = np.array(data[data.Class == <span class="number">1</span>].index)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Picking the indices of the normal classes</span></span><br><span class="line">normal_indices = data[data.Class == <span class="number">0</span>].index</span><br><span class="line"></span><br><span class="line"><span class="comment"># Out of the indices we picked, randomly select "x" number (number_records_fraud)</span></span><br><span class="line"><span class="comment"># 随机选取（选取的东西，数量，是否代替）</span></span><br><span class="line">random_normal_indices = np.random.choice(normal_indices, number_records_fraud, replace = <span class="keyword">False</span>)</span><br><span class="line">random_normal_indices = np.array(random_normal_indices)</span><br><span class="line"><span class="comment"># 之所以将其都转换为np.array格式是为了后面的合并操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Appending the 2 indices</span></span><br><span class="line">under_sample_indices = np.concatenate([fraud_indices,random_normal_indices])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Under sample dataset</span></span><br><span class="line">under_sample_data = data.iloc[under_sample_indices,:]</span><br><span class="line"></span><br><span class="line">X_undersample = under_sample_data.iloc[:, under_sample_data.columns != <span class="string">'Class'</span>]</span><br><span class="line">y_undersample = under_sample_data.iloc[:, under_sample_data.columns == <span class="string">'Class'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Showing ratio</span></span><br><span class="line">print(<span class="string">"Percentage of normal transactions: "</span>, len(under_sample_data[under_sample_data.Class == <span class="number">0</span>])/len(under_sample_data))</span><br><span class="line">print(<span class="string">"Percentage of fraud transactions: "</span>, len(under_sample_data[under_sample_data.Class == <span class="number">1</span>])/len(under_sample_data))</span><br><span class="line">print(<span class="string">"Total number of transactions in resampled data: "</span>, len(under_sample_data))</span><br></pre></td></tr></table></figure>
<pre><code>Percentage of normal transactions:  0.5
Percentage of fraud transactions:  0.5
Total number of transactions in resampled data:  984
</code></pre><h2 id="开始机器学习"><a href="#开始机器学习" class="headerlink" title="开始机器学习"></a>开始机器学习</h2><h3 id="交叉验证的数据处理"><a href="#交叉验证的数据处理" class="headerlink" title="交叉验证的数据处理"></a>交叉验证的数据处理</h3><p>选取一部分数据做训练集，另外的做测试集（绝对不能够在测试阶段使用），然后开始机器学习。<br>之后再对训练集处理，比如说分成三份，一部分做训练，剩下的做测试，这样轮回几次，这就叫做交叉验证。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cross_validation 交叉验证包，train_test_split帮助我们切分</span></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="comment"># Whole dataset</span></span><br><span class="line"><span class="comment"># test_size,多少百分比的数据用来测试</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X,y,test_size = <span class="number">0.3</span>, random_state = <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Number transactions train dataset: "</span>, len(X_train))</span><br><span class="line">print(<span class="string">"Number transactions test dataset: "</span>, len(X_test))</span><br><span class="line">print(<span class="string">"Total number of transactions: "</span>, len(X_train)+len(X_test))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Undersampled dataset</span></span><br><span class="line"><span class="comment"># 对训练数据再次分割</span></span><br><span class="line">X_train_undersample, X_test_undersample, y_train_undersample, y_test_undersample = train_test_split(X_undersample</span><br><span class="line">                                                                                                   ,y_undersample</span><br><span class="line">                                                                                                   ,test_size = <span class="number">0.3</span></span><br><span class="line">                                                                                                   ,random_state = <span class="number">0</span>)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(<span class="string">"Number transactions train dataset: "</span>, len(X_train_undersample))</span><br><span class="line">print(<span class="string">"Number transactions test dataset: "</span>, len(X_test_undersample))</span><br><span class="line">print(<span class="string">"Total number of transactions: "</span>, len(X_train_undersample)+len(X_test_undersample))</span><br></pre></td></tr></table></figure>
<pre><code>Number transactions train dataset:  199364
Number transactions test dataset:  85443
Total number of transactions:  284807

Number transactions train dataset:  688
Number transactions test dataset:  296
Total number of transactions:  984
</code></pre><h3 id="开始建模"><a href="#开始建模" class="headerlink" title="开始建模"></a>开始建模</h3><h4 id="建立模型的包的导入"><a href="#建立模型的包的导入" class="headerlink" title="建立模型的包的导入"></a>建立模型的包的导入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Recall = TP/(TP+FN) 查全率，正例预测全的比例</span></span><br><span class="line"><span class="comment"># TP正例预测对了</span></span><br><span class="line"><span class="comment"># FP负类判断为正例==&gt;取伪</span></span><br><span class="line"><span class="comment"># FN 弃真</span></span><br><span class="line"><span class="comment"># TN负例判断对了</span></span><br><span class="line"><span class="comment"># sklearn自带的处理数据的包</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="comment"># 交叉验证，K_fold是指做几倍的交叉验证，cross_val_score==&gt;交叉验证结果</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> KFold, cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix,recall_score,classification_report</span><br></pre></td></tr></table></figure>
<pre><code>C:\Users\jiawe\Anaconda3\lib\site-packages\sklearn\cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  &quot;This module will be removed in 0.20.&quot;, DeprecationWarning)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printing_Kfold_scores</span><span class="params">(x_train_data,y_train_data)</span>:</span></span><br><span class="line">    <span class="comment"># （数量，几份，洗牌）</span></span><br><span class="line">    fold = KFold(len(y_train_data),<span class="number">5</span>,shuffle=<span class="keyword">False</span>) </span><br><span class="line"></span><br><span class="line">    <span class="comment"># Different C parameters</span></span><br><span class="line">    <span class="comment"># 正则化惩罚项，正则化：</span></span><br><span class="line">    <span class="comment"># L2正则化加上a*误差的平方，L1正则化加上a*误差的绝对值,a越大，惩罚力度越大</span></span><br><span class="line">    <span class="comment"># a的值需要通过实验得到</span></span><br><span class="line">    c_param_range = [<span class="number">0.01</span>,<span class="number">0.1</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">    results_table = pd.DataFrame(index = range(len(c_param_range),<span class="number">2</span>), columns = [<span class="string">'C_parameter'</span>,<span class="string">'Mean recall score'</span>])</span><br><span class="line">    results_table[<span class="string">'C_parameter'</span>] = c_param_range</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the k-fold will give 2 lists: train_indices = indices[0], test_indices = indices[1]</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> c_param <span class="keyword">in</span> c_param_range:</span><br><span class="line">        print(<span class="string">'-------------------------------------------'</span>)</span><br><span class="line">        print(<span class="string">'C parameter: '</span>, c_param)</span><br><span class="line">        print(<span class="string">'-------------------------------------------'</span>)</span><br><span class="line">        print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">        recall_accs = []</span><br><span class="line">        <span class="keyword">for</span> iteration, indices <span class="keyword">in</span> enumerate(fold,start=<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Call the logistic regression model with a certain C parameter</span></span><br><span class="line">            <span class="comment"># sklearn的传统，先实例化模型，实例化只传入一些参数</span></span><br><span class="line">            <span class="comment"># （惩罚力度，惩罚方式）</span></span><br><span class="line">            lr = LogisticRegression(C = c_param, penalty = <span class="string">'l1'</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Use the training data to fit the model. In this case, we use the portion of the fold to train the model</span></span><br><span class="line">            <span class="comment"># with indices[0]. We then predict on the portion assigned as the 'test cross validation' with indices[1]</span></span><br><span class="line">            <span class="comment"># 开始训练</span></span><br><span class="line">            lr.fit(x_train_data.iloc[indices[<span class="number">0</span>],:],y_train_data.iloc[indices[<span class="number">0</span>],:].values.ravel())</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Predict values using the test indices in the training data</span></span><br><span class="line">            <span class="comment"># 验证效果</span></span><br><span class="line">            y_pred_undersample = lr.predict(x_train_data.iloc[indices[<span class="number">1</span>],:].values)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Calculate the recall score and append it to a list for recall scores representing the current c_parameter</span></span><br><span class="line">            recall_acc = recall_score(y_train_data.iloc[indices[<span class="number">1</span>],:].values,y_pred_undersample)</span><br><span class="line">            recall_accs.append(recall_acc)</span><br><span class="line">            print(<span class="string">'Iteration '</span>, iteration,<span class="string">': recall score = '</span>, recall_acc)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># The mean value of those recall scores is the metric we want to save and get hold of.</span></span><br><span class="line">        results_table.loc[j,<span class="string">'Mean recall score'</span>] = np.mean(recall_accs)</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        print(<span class="string">''</span>)</span><br><span class="line">        print(<span class="string">'Mean recall score '</span>, np.mean(recall_accs))</span><br><span class="line">        print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">    best_c = results_table.loc[results_table[<span class="string">'Mean recall score'</span>].idxmax()][<span class="string">'C_parameter'</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Finally, we can check which C parameter is the best amongst the chosen.</span></span><br><span class="line">    print(<span class="string">'*********************************************************************************'</span>)</span><br><span class="line">    print(<span class="string">'Best model to choose from cross validation is with C parameter = '</span>, best_c)</span><br><span class="line">    print(<span class="string">'*********************************************************************************'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> best_c</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">best_c = printing_Kfold_scores(X_train_undersample,y_train_undersample)</span><br></pre></td></tr></table></figure>
<pre><code>-------------------------------------------
C parameter:  0.01
-------------------------------------------

Iteration  1 : recall score =  0.931506849315
Iteration  2 : recall score =  0.917808219178
Iteration  3 : recall score =  1.0
Iteration  4 : recall score =  0.972972972973
Iteration  5 : recall score =  0.954545454545

Mean recall score  0.955366699202

-------------------------------------------
C parameter:  0.1
-------------------------------------------

Iteration  1 : recall score =  0.849315068493
Iteration  2 : recall score =  0.86301369863
Iteration  3 : recall score =  0.966101694915
Iteration  4 : recall score =  0.945945945946
Iteration  5 : recall score =  0.909090909091

Mean recall score  0.906693463415

-------------------------------------------
C parameter:  1
-------------------------------------------

Iteration  1 : recall score =  0.86301369863
Iteration  2 : recall score =  0.876712328767
Iteration  3 : recall score =  0.983050847458
Iteration  4 : recall score =  0.945945945946
Iteration  5 : recall score =  0.909090909091

Mean recall score  0.915562745978

-------------------------------------------
C parameter:  10
-------------------------------------------

Iteration  1 : recall score =  0.876712328767
Iteration  2 : recall score =  0.904109589041
Iteration  3 : recall score =  0.983050847458
Iteration  4 : recall score =  0.945945945946
Iteration  5 : recall score =  0.909090909091

Mean recall score  0.923781924061

-------------------------------------------
C parameter:  100
-------------------------------------------

Iteration  1 : recall score =  0.876712328767
Iteration  2 : recall score =  0.904109589041
Iteration  3 : recall score =  0.983050847458
Iteration  4 : recall score =  0.945945945946
Iteration  5 : recall score =  0.924242424242

Mean recall score  0.926812227091

*********************************************************************************
Best model to choose from cross validation is with C parameter =  0.01
*********************************************************************************
</code></pre><h3 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_confusion_matrix</span><span class="params">(cm, classes,</span></span></span><br><span class="line"><span class="function"><span class="params">                          title=<span class="string">'Confusion matrix'</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">                          cmap=plt.cm.Blues)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    This function prints and plots the confusion matrix.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    plt.imshow(cm, interpolation=<span class="string">'nearest'</span>, cmap=cmap)</span><br><span class="line">    plt.title(title)</span><br><span class="line">    plt.colorbar()</span><br><span class="line">    tick_marks = np.arange(len(classes))</span><br><span class="line">    plt.xticks(tick_marks, classes, rotation=<span class="number">0</span>)</span><br><span class="line">    plt.yticks(tick_marks, classes)</span><br><span class="line"></span><br><span class="line">    thresh = cm.max() / <span class="number">2.</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> itertools.product(range(cm.shape[<span class="number">0</span>]), range(cm.shape[<span class="number">1</span>])):</span><br><span class="line">        plt.text(j, i, cm[i, j],</span><br><span class="line">                 horizontalalignment=<span class="string">"center"</span>,</span><br><span class="line">                 color=<span class="string">"white"</span> <span class="keyword">if</span> cm[i, j] &gt; thresh <span class="keyword">else</span> <span class="string">"black"</span>)</span><br><span class="line"></span><br><span class="line">    plt.tight_layout()</span><br><span class="line">    plt.ylabel(<span class="string">'True label'</span>)</span><br><span class="line">    plt.xlabel(<span class="string">'Predicted label'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">lr = LogisticRegression(C = best_c, penalty = <span class="string">'l1'</span>)</span><br><span class="line">lr.fit(X_train_undersample,y_train_undersample.values.ravel())</span><br><span class="line">y_pred_undersample = lr.predict(X_test_undersample.values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute confusion matrix</span></span><br><span class="line">cnf_matrix = confusion_matrix(y_test_undersample,y_pred_undersample)</span><br><span class="line">np.set_printoptions(precision=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Recall metric in the testing dataset: "</span>, cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]/(cnf_matrix[<span class="number">1</span>,<span class="number">0</span>]+cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot non-normalized confusion matrix</span></span><br><span class="line">class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">plt.figure()</span><br><span class="line">plot_confusion_matrix(cnf_matrix</span><br><span class="line">                      , classes=class_names</span><br><span class="line">                      , title=<span class="string">'Confusion matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<pre><code>Recall metric in the testing dataset:  0.931972789116
</code></pre><p>​    </p>
<p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_22_1.png" alt="png"></p>
<h3 id="用元数据来检验"><a href="#用元数据来检验" class="headerlink" title="用元数据来检验"></a>用元数据来检验</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">lr = LogisticRegression(C = best_c, penalty = <span class="string">'l1'</span>)</span><br><span class="line">lr.fit(X_train_undersample,y_train_undersample.values.ravel())</span><br><span class="line">y_pred = lr.predict(X_test.values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute confusion matrix</span></span><br><span class="line">cnf_matrix = confusion_matrix(y_test,y_pred)</span><br><span class="line">np.set_printoptions(precision=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Recall metric in the testing dataset: "</span>, cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]/(cnf_matrix[<span class="number">1</span>,<span class="number">0</span>]+cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot non-normalized confusion matrix</span></span><br><span class="line">class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">plt.figure()</span><br><span class="line">plot_confusion_matrix(cnf_matrix</span><br><span class="line">                      , classes=class_names</span><br><span class="line">                      , title=<span class="string">'Confusion matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<pre><code>Recall metric in the testing dataset:  0.918367346939
</code></pre><p>​    </p>
<p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_24_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">best_c = printing_Kfold_scores(X_train,y_train)</span><br></pre></td></tr></table></figure>
<pre><code>-------------------------------------------
C parameter:  0.01
-------------------------------------------

Iteration  1 : recall score =  0.492537313433
Iteration  2 : recall score =  0.602739726027
Iteration  3 : recall score =  0.683333333333
Iteration  4 : recall score =  0.569230769231
Iteration  5 : recall score =  0.45

Mean recall score  0.559568228405

-------------------------------------------
C parameter:  0.1
-------------------------------------------

Iteration  1 : recall score =  0.567164179104
Iteration  2 : recall score =  0.616438356164
Iteration  3 : recall score =  0.683333333333
Iteration  4 : recall score =  0.584615384615
Iteration  5 : recall score =  0.525

Mean recall score  0.595310250644

-------------------------------------------
C parameter:  1
-------------------------------------------

Iteration  1 : recall score =  0.55223880597
Iteration  2 : recall score =  0.616438356164
Iteration  3 : recall score =  0.716666666667
Iteration  4 : recall score =  0.615384615385
Iteration  5 : recall score =  0.5625

Mean recall score  0.612645688837

-------------------------------------------
C parameter:  10
-------------------------------------------

Iteration  1 : recall score =  0.55223880597
Iteration  2 : recall score =  0.616438356164
Iteration  3 : recall score =  0.733333333333
Iteration  4 : recall score =  0.615384615385
Iteration  5 : recall score =  0.575

Mean recall score  0.61847902217

-------------------------------------------
C parameter:  100
-------------------------------------------

Iteration  1 : recall score =  0.55223880597
Iteration  2 : recall score =  0.616438356164
Iteration  3 : recall score =  0.733333333333
Iteration  4 : recall score =  0.615384615385
Iteration  5 : recall score =  0.575

Mean recall score  0.61847902217

*********************************************************************************
Best model to choose from cross validation is with C parameter =  10.0
*********************************************************************************
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">lr = LogisticRegression(C = best_c, penalty = <span class="string">'l1'</span>)</span><br><span class="line">lr.fit(X_train,y_train.values.ravel())</span><br><span class="line">y_pred_undersample = lr.predict(X_test.values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute confusion matrix</span></span><br><span class="line">cnf_matrix = confusion_matrix(y_test,y_pred_undersample)</span><br><span class="line">np.set_printoptions(precision=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Recall metric in the testing dataset: "</span>, cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]/(cnf_matrix[<span class="number">1</span>,<span class="number">0</span>]+cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot non-normalized confusion matrix</span></span><br><span class="line">class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">plt.figure()</span><br><span class="line">plot_confusion_matrix(cnf_matrix</span><br><span class="line">                      , classes=class_names</span><br><span class="line">                      , title=<span class="string">'Confusion matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<pre><code>Recall metric in the testing dataset:  0.619047619048
</code></pre><p>​    </p>
<p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_26_1.png" alt="png"></p>
<h3 id="逻辑回归阈值调整"><a href="#逻辑回归阈值调整" class="headerlink" title="逻辑回归阈值调整"></a>逻辑回归阈值调整</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">lr = LogisticRegression(C = <span class="number">0.01</span>, penalty = <span class="string">'l1'</span>)</span><br><span class="line">lr.fit(X_train_undersample,y_train_undersample.values.ravel())</span><br><span class="line">y_pred_undersample_proba = lr.predict_proba(X_test_undersample.values)</span><br><span class="line"></span><br><span class="line">thresholds = [<span class="number">0.1</span>,<span class="number">0.2</span>,<span class="number">0.3</span>,<span class="number">0.4</span>,<span class="number">0.5</span>,<span class="number">0.6</span>,<span class="number">0.7</span>,<span class="number">0.8</span>,<span class="number">0.9</span>]</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>,<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">j = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> thresholds:</span><br><span class="line">    y_test_predictions_high_recall = y_pred_undersample_proba[:,<span class="number">1</span>] &gt; i</span><br><span class="line">    </span><br><span class="line">    plt.subplot(<span class="number">3</span>,<span class="number">3</span>,j)</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Compute confusion matrix</span></span><br><span class="line">    cnf_matrix = confusion_matrix(y_test_undersample,y_test_predictions_high_recall)</span><br><span class="line">    np.set_printoptions(precision=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"Recall metric in the testing dataset: "</span>, cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]/(cnf_matrix[<span class="number">1</span>,<span class="number">0</span>]+cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Plot non-normalized confusion matrix</span></span><br><span class="line">    class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">    plot_confusion_matrix(cnf_matrix</span><br><span class="line">                          , classes=class_names</span><br><span class="line">                          , title=<span class="string">'Threshold &gt;= %s'</span>%i)</span><br></pre></td></tr></table></figure>
<pre><code>Recall metric in the testing dataset:  1.0
Recall metric in the testing dataset:  1.0
Recall metric in the testing dataset:  1.0
Recall metric in the testing dataset:  0.972789115646
Recall metric in the testing dataset:  0.931972789116
Recall metric in the testing dataset:  0.884353741497
Recall metric in the testing dataset:  0.829931972789
Recall metric in the testing dataset:  0.775510204082
Recall metric in the testing dataset:  0.591836734694
</code></pre><p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_28_1.png" alt="png"></p>
<h2 id="过采样"><a href="#过采样" class="headerlink" title="过采样"></a>过采样</h2><h3 id="包的导入"><a href="#包的导入" class="headerlink" title="包的导入"></a>包的导入</h3><h3 id="smote算法"><a href="#smote算法" class="headerlink" title="smote算法"></a>smote算法</h3><ul>
<li>简而言之,smote算法就是指将某个点与其周围所有的同类的点的距离都算出来,之后将这个距离乘上一个零到一之间的数.</li>
<li>根据样本不均衡情况设定一个采样比例N,对于每一个少数类样本x,从其k近邻中随机选取若干个样本,假设选的的近邻为xn</li>
<li>对于每一个选取出来的近邻xn,分别语言样本按照如下的公式构建新的样本.</li>
<li>X_new = x + rand(0,1)*(xn-x)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># imblearn是一个k近邻的包,smote是一种算法</span></span><br><span class="line"><span class="keyword">from</span> imblearn.over_sampling <span class="keyword">import</span> SMOTE <span class="comment">#new</span></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier <span class="comment">#new</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">credit_cards=pd.read_csv(<span class="string">'creditcard.csv'</span>)</span><br><span class="line"></span><br><span class="line">columns=credit_cards.columns</span><br><span class="line"><span class="comment"># The labels are in the last column ('Class'). Simply remove it to obtain features columns</span></span><br><span class="line">features_columns=columns.delete(len(columns)<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">features=credit_cards[features_columns]</span><br><span class="line">labels=credit_cards[<span class="string">'Class'</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">features_train, features_test, labels_train, labels_test = train_test_split(features, </span><br><span class="line">                                                                            labels, </span><br><span class="line">                                                                            test_size=<span class="number">0.2</span>, </span><br><span class="line">                                                                            random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先实例化对象,等于0是指默认一样</span></span><br><span class="line">oversampler=SMOTE(random_state=<span class="number">0</span>)</span><br><span class="line">os_features,os_labels=oversampler.fit_sample(features_train,labels_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(os_labels[os_labels==<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<pre><code>227454
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">os_features = pd.DataFrame(os_features)</span><br><span class="line">os_labels = pd.DataFrame(os_labels)</span><br><span class="line">best_c = printing_Kfold_scores(os_features,os_labels)</span><br></pre></td></tr></table></figure>
<pre><code>-------------------------------------------
C parameter:  0.01
-------------------------------------------

Iteration  1 : recall score =  0.890322580645
Iteration  2 : recall score =  0.894736842105
Iteration  3 : recall score =  0.968861347792
Iteration  4 : recall score =  0.957881315879
Iteration  5 : recall score =  0.958364933338

Mean recall score  0.934033403952

-------------------------------------------
C parameter:  0.1
-------------------------------------------

Iteration  1 : recall score =  0.890322580645
Iteration  2 : recall score =  0.894736842105
Iteration  3 : recall score =  0.970410534469
Iteration  4 : recall score =  0.959727855266
Iteration  5 : recall score =  0.960750046713

Mean recall score  0.93518957184

-------------------------------------------
C parameter:  1
-------------------------------------------

Iteration  1 : recall score =  0.890322580645
Iteration  2 : recall score =  0.894736842105
Iteration  3 : recall score =  0.970543321899
Iteration  4 : recall score =  0.960299403172
Iteration  5 : recall score =  0.960805003242

Mean recall score  0.935341430213

-------------------------------------------
C parameter:  10
-------------------------------------------

Iteration  1 : recall score =  0.890322580645
Iteration  2 : recall score =  0.894736842105
Iteration  3 : recall score =  0.970366271993
Iteration  4 : recall score =  0.960376342313
Iteration  5 : recall score =  0.96083797716

Mean recall score  0.935328002843

-------------------------------------------
C parameter:  100
-------------------------------------------

Iteration  1 : recall score =  0.890322580645
Iteration  2 : recall score =  0.894736842105
Iteration  3 : recall score =  0.970565453137
Iteration  4 : recall score =  0.960310394478
Iteration  5 : recall score =  0.960607159737

Mean recall score  0.93530848602

*********************************************************************************
Best model to choose from cross validation is with C parameter =  1.0
*********************************************************************************
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">lr = LogisticRegression(C = best_c, penalty = <span class="string">'l1'</span>)</span><br><span class="line">lr.fit(os_features,os_labels.values.ravel())</span><br><span class="line">y_pred = lr.predict(features_test.values)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute confusion matrix</span></span><br><span class="line">cnf_matrix = confusion_matrix(labels_test,y_pred)</span><br><span class="line">np.set_printoptions(precision=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Recall metric in the testing dataset: "</span>, cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]/(cnf_matrix[<span class="number">1</span>,<span class="number">0</span>]+cnf_matrix[<span class="number">1</span>,<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot non-normalized confusion matrix</span></span><br><span class="line">class_names = [<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line">plt.figure()</span><br><span class="line">plot_confusion_matrix(cnf_matrix</span><br><span class="line">                      , classes=class_names</span><br><span class="line">                      , title=<span class="string">'Confusion matrix'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<pre><code>Recall metric in the testing dataset:  0.910891089109
</code></pre><p>​    </p>
<p><img src="/gao/2018/01/01/LogisticRegression-CreditCard/output_36_1.png" alt="png"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/gao/tags/机器学习/" rel="tag"># 机器学习</a>
          
            <a href="/gao/tags/编程/" rel="tag"># 编程</a>
          
            <a href="/gao/tags/python/" rel="tag"># python</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/gao/2018/01/01/沉思录1/" rel="next" title="《沉思录》卷二-摘录(1)">
                <i class="fa fa-chevron-left"></i> 《沉思录》卷二-摘录(1)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/gao/upload/image/me.png"
                alt="Jiawei" />
            
              <p class="site-author-name" itemprop="name">Jiawei</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/gao/archives/">
              
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/gao/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/gao/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/jiaweigoah" target="_blank" title="github">
                      
                        <i class="fa fa-fw fa-globe"></i>github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://gaojiawei.gitee.io/gao/about/wechat.jpg" target="_blank" title="wechat">
                      
                        <i class="fa fa-fw fa-globe"></i>wechat</a>
                  </span>
                
            </div>
          

          
          

          
          

          
<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
<div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div id="myCanvasContainer" class="widget tagcloud">
        <canvas width="250" height="250" id="resCanvas" style="width=100%">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/gao/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/gao/tags/《沉思录》/">《沉思录》</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/gao/tags/机器学习/">机器学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/gao/tags/编程/">编程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/gao/tags/读书/">读书</a><span class="tag-list-count">1</span></li></ul>
        </canvas>
    </div>
</div>


        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#准备工作"><span class="nav-number">1.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据处理"><span class="nav-number">2.</span> <span class="nav-text">数据处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#统计数据样本分布是否均衡"><span class="nav-number">2.1.</span> <span class="nav-text">统计数据样本分布是否均衡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#下采样"><span class="nav-number">2.1.1.</span> <span class="nav-text">下采样</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#上采样"><span class="nav-number">2.1.2.</span> <span class="nav-text">上采样</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#处理权重数据"><span class="nav-number">2.2.</span> <span class="nav-text">处理权重数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#下采样-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">下采样</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#开始机器学习"><span class="nav-number">3.</span> <span class="nav-text">开始机器学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#交叉验证的数据处理"><span class="nav-number">3.1.</span> <span class="nav-text">交叉验证的数据处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开始建模"><span class="nav-number">3.2.</span> <span class="nav-text">开始建模</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#建立模型的包的导入"><span class="nav-number">3.2.1.</span> <span class="nav-text">建立模型的包的导入</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#混淆矩阵"><span class="nav-number">3.3.</span> <span class="nav-text">混淆矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用元数据来检验"><span class="nav-number">3.4.</span> <span class="nav-text">用元数据来检验</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逻辑回归阈值调整"><span class="nav-number">3.5.</span> <span class="nav-text">逻辑回归阈值调整</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过采样"><span class="nav-number">4.</span> <span class="nav-text">过采样</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#包的导入"><span class="nav-number">4.1.</span> <span class="nav-text">包的导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#smote算法"><span class="nav-number">4.2.</span> <span class="nav-text">smote算法</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiawei</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/gao/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/gao/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/gao/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/gao/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/gao/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/gao/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/gao/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/gao/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/gao/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/gao/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/gao/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
